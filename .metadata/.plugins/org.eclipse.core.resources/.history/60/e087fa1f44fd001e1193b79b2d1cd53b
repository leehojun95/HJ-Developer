package sec07;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

// 데이터베이스 연동기능(연결하고 동작(SQL문 실행))
// JDK안에 JDBC기능 라이브러리.
public class MemberDAO {

	
	private Connection conn; // 데이터베이스 연결목적
	private PreparedStatement pstmt; // 연결상태에서 SQL문 실행목적
	private ResultSet rs; // SQL문 Select문 실행시 출력되는 결과를 저장하는 목적.
	
	private String url = "jdbc:oracle:thin:@localhost:1521:xe";
	private String uid = "jspuser";
	private String pw = "jspuser";
	
	public MemberDAO() {
		
	}
	
	public Connection getConnection() throws SQLException {
		if(conn == null || conn.isClosed()) {
			try {
				// 메모리상에 DriverManager 객체가 로딩.
				// "oracle.jdbc.OracleDriver" 오라클에서 제공하는 JDBC 들아ㅣ버에서 참조.
				Class.forName("oracle.jdbc.OracleDriver");
			} catch (ClassNotFoundException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
			
			// conn 객체가 생성된다.(데이터베이스와 연결상태)
			// conn 객체가 오류가 나면, url, uid, pw 파라미터값이 문제일 수 있다.
			conn = DriverManager.getConnection(url, uid, pw);
		}
		
		return conn;
		
	}
	
	//회원가입(insert)
	public void insMember(MemberVO vo) {
		try {
			conn = getConnection();
			
			String id = vo.getId();
			String pwd = vo.getPwd();
			String name = vo.getName();
			String email = vo.getEmail();
			
			String sql = "insert into t_member(id,pwd,name,email)";
			sql +=" values(?, ?, ?, ?)";
			
			// sql변수안에 insert문이 완성된다.
			pstmt = conn.prepareStatement(sql);
			pstmt.setString(1, id);
			pstmt.setString(2, pwd);
			pstmt.setString(3, name);
			pstmt.setString(4, email);
			
			//sql변수의 insert문을 실행용청한다.
			pstmt.executeUpdate();
			
			
			pstmt.close();
			
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
	}
	
	//회원삭제(delete)
	
	//회원목록(select)
}
